@startuml
'https://plantuml.com/class-diagram
skinparam classAttributeIconSize 0
skinparam groupInheritance 3
hide empty methods
hide empty members

class SmtpClient {
    {static} + main(String[] args): void
    + SmtpClient(String victimFile, String messageFile, int groupCount)
    + run(): void
}

class SmtpHandler {
    + handle(Socket socket, Worker worker)
}

class Worker {
    Worker(Mail[] mails)
    - headerEhlo(): boolean
    - headerFrom(): boolean
    - headerTo(): boolean
    - messagePreamble(): boolean
    - messageBody(): boolean
    + transact(): void
}

class Parser {
    Parser(String victimFile, String messageFile, int groupCount)
    - selectMessage(): String
    - selectVictims(): String[]
    + formGroups(): Mail[]
    {static} + parseFile(String path) : String[]
}

class Mail {
    - String[] receivers
    - String message

    Mail(String[] receivers, String message)
    + getSender(): String
    + getReceivers(): String[]
    + getMessage(): String
}


SmtpClient ..> SmtpHandler
SmtpClient ..> Parser
SmtpHandler .down.> Worker
Parser ..> Mail
Worker .r.> Mail

@enduml