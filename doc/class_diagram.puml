@startuml
'https://plantuml.com/class-diagram
skinparam classAttributeIconSize 0
skinparam groupInheritance 3
hide empty methods
hide empty members

class Client {
    {static} + main(String[] args): void
    - mails: Mail[]
    + Client(String victimFile, String messageFile, int groupCount)
    + execute(): void
}

class Handler {
    - socket: Socket
    - worker: Worker
    Handler(Socket socket, Worker worker)
    + run() : void
}

class Worker {
    Worker(Mail mail)
    + work(String message) : String
    - identity(): String
    - mailHeader(): String
    - mailBody(): String
}

enum SmtpCommand {
    EHLO
    MAIL
    RCPT
    DATA
    QUIT
}

enum SmtpStatus {
    220
    221
    250
    354
}

class Parser {
    - groups: Mail[]
    Parser(String victimFile, String messageFile, int groupCount)
    - selectMessage(messages: String[]): String
    - selectCandidate(candidates: String[]): String
    - selectVictims(candidates: String[]): String[]
    + getGroups(): Mail[]
    {static} - parseFile(String path) : String[]
}

class Mail {
    - receivers: String[]
    - message: String
    Mail(String[] receivers, String message)
    + getSender(): String
    + getReceivers(): String[]
    + getMessage(): String
}

interface Runnable

Client ..> Handler
Client ..> Parser
Handler .down.> Worker
Runnable .right.|> Handler
Parser ..> Mail
Worker "*" -right-> "1" Mail : "Message >"
Worker "*" -left-> "1" SmtpProcedureStep : "State >"
Worker .down.> SmtpStatus
@enduml